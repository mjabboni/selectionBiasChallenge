---
title: "Selection Bias Demonstration"
subtitle: "A Visual Statistics Meme"
format:
  html: default
execute:
  echo: false
  eval: true
---

```{python}
#| label: step1-prepare
#| echo: false
#| output: false

import numpy as np
import matplotlib.pyplot as plt
from step1_prepare_image import prepare_image

# Load and prepare the image
img_path = 'mike.abbo.jpg'
gray_image = prepare_image(img_path, max_size=512)
```

```{python}
#| label: step2-stipple
#| echo: false
#| output: false
#| message: false
#| warning: false

from step2_create_stipple import create_stipple

# Create stippled image
stipple_pattern, samples = create_stipple(
    gray_image,
    percentage=0.08,
    sigma=0.9,
    content_bias=0.9,
    noise_scale_factor=0.1,
    extreme_downweight=0.5,
    extreme_threshold_low=0.2,
    extreme_threshold_high=0.8,
    extreme_sigma=0.1
)
```

```{python}
#| label: step4-block-letter
#| echo: false
#| output: false

from step4_create_block_letter import create_block_letter_s

# Get image dimensions
h, w = gray_image.shape

# Create block letter S
block_letter = create_block_letter_s(h, w, letter="S", font_size_ratio=0.9)
```

```{python}
#| label: step5-masked
#| echo: false
#| output: false

from step5_create_masked import create_masked_stipple

# Create masked stippled image
masked_stipple = create_masked_stipple(
    stipple_pattern,
    block_letter,
    threshold=0.5
)
```

```{python}
#| label: create-final-meme
#| echo: false
#| output: false

from create_meme import create_statistics_meme

# Create the final meme
create_statistics_meme(
    original_img=gray_image,
    stipple_img=stipple_pattern,
    block_letter_img=block_letter,
    masked_stipple_img=masked_stipple,
    output_path="my_statistics_meme.png",
    dpi=150,
    background_color="white"
)
```

## The Meme

```{python}
#| label: final-meme-output
#| echo: false
#| fig-cap: "Statistics meme demonstrating selection bias"
#| layout-ncol: 2

import matplotlib.pyplot as plt

# Create figure with subplots for each component
fig, axes = plt.subplots(2, 2, figsize=(12, 8))

# Original Image (Reality)
axes[0, 0].imshow(gray_image, cmap='gray')
axes[0, 0].set_title('Reality', fontsize=10, fontweight='bold')
axes[0, 0].axis('off')

# Stippled Image (Your Model)
axes[0, 1].imshow(stipple_pattern, cmap='gray')
axes[0, 1].set_title('Your Model', fontsize=10, fontweight='bold')
axes[0, 1].axis('off')

# Block Letter (Selection Bias Pattern)
axes[1, 0].imshow(block_letter, cmap='gray')
axes[1, 0].set_title('Selection Bias (S)', fontsize=10, fontweight='bold')
axes[1, 0].axis('off')

# Masked Stipple (Biased Estimate)
axes[1, 1].imshow(masked_stipple, cmap='gray')
axes[1, 1].set_title('Biased Estimate', fontsize=10, fontweight='bold')
axes[1, 1].axis('off')

plt.tight_layout()
plt.show()
```

## Understanding Selection Bias

This meme demonstrates selection bias by showing how systematic missing data patterns distort our understanding of reality. The original image (Reality) represents the true population, while the stippled version (Your Model) shows our data collection. When selection bias removes data points in a systematic "S" pattern, the resulting estimate becomes biased and no longer represents the true population, just as missing data in real-world studies can lead to incorrect conclusions.

